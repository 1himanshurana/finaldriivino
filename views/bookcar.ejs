<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link
    href="https://cdn.jsdelivr.net/npm/remixicon@4.2.0/fonts/remixicon.css"
    rel="stylesheet"/>
<link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
<link rel="preconnect" href="https://fonts.googleapis.com">
<style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap');

*{
    font-family: "Poppins", sans-serif;
    margin: 0;
    padding: 0;
    scroll-padding: 2rem;
    box-sizing: border-box;
    scroll-behavior: smooth;
    list-style-type: none;
    text-decoration: none;
}
body{
    background:linear-gradient(to right,#fc492a,#2f6df3);
}

a{
    color: black;
}


:root{
--main-color:#a1ee12bb;
--second-color:#f7741e;
--text-color:#444;
--gradient:linear-gradient(#fe5b3d,#ffac38)
}
header{
position: sticky;
width: 100%;
top: 0;
right: 0;
z-index: 100;
display: flex;
align-items:flex-end;
justify-content: space-between;
background:var(--main-color);
padding: 15px 12px;
background:linear-gradient(to right,#fe5b3d,#5586f0);

}
.navbar{
display:flex;
}
.navbar li{
position: relative;
}
.navbar a{
font-size: 1rem;
padding: 8px 30px;
color:var(--text-color);
font-weight: 500;

}

.navbar a.hover::after{
content: '';
position: absolute;
left: 0;
bottom: -4px;
width: 100%;
height: 3px;
background: var(--gradient);
/* background: white; */
border-radius: 5px;
/* transform-origin: right; */
transform: scaleX(0);
transition:transform .3s;
}
.navbar a:hover::after{
/* transform-origin: left; */
transform: scaleX(1);

}

.navbar li  #login-btn{
/* width: 120px;
height: 35px; */
/* background: transparent; */
background:rgb(255, 196, 0);
border-radius: 6px;
/* transition: .5s; */


}
.navbar li  #login-btn:hover{
background: #474fa0;
}
/* .header{
} */

#afterlogin{
    background:rgb(255, 196, 0);
border-radius: 6px;
}





.dtails {
    width: 40vw;
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin: 3px 11px;
}
.pinline{
    display: inline;
}
.mainhead{
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin: 3px 18px;
}
.location-info span{
    margin-right:8px
}

.current-page {
    background: rgba(0, 0, 0, 0.075);
    border-radius: 8px;
  }


#menu-icon{
    display: none;
}

  


/* Dropdown Button */
.dropbtn {
    display: none;
  cursor: pointer;
}


/* The container <div> - needed to position the dropdown content */
.dropdown {
  position: relative;
  display: inline-block;
}

/* Dropdown Content (Hidden by Default) */
.dropdown-content {
    border-radius: 9px;
    /* display: none; */
    opacity: 0;
  position: absolute;
  background-color: #f9f9f9;
  min-width: 160px;
  box-shadow: 0px 8px 16px 0px rgba(80, 77, 77, 0.384);
  z-index: 1;

}

/* Links inside the dropdown */
.dropdown-content a {
    border-radius: 9px;
  color: black;
  text-decoration: none;
  display: block;
  
}

/* Change color of dropdown links on hover */
#logoutbtn:hover:hover {
    border-radius: 9px;
  background-color: #f1f1f1;
}

/* Show the dropdown menu on hover */
.dropdown:hover .dropdown-content {
    margin-top: 5px;
  display: block;
  opacity: 1;
  transition: .1s ease;
  backdrop-filter:blur(5px) ;
}

.parent{
    /* text-align: center; */
    width: 95vw;
    height: 85vh;
}
.container{
    position: relative;
    top:30px;
    width: 80%;
    height: 60%;
    display: flex;
    margin: 0 auto;
    gap: 20px;
}
.confirmbooking{
    position: relative;
    top:30px;
    width: 80%;
    height: 60%;
    display: flex;
    margin: 0 auto;
    gap: 20px;
}
.right{
    margin-top:50px;
    width: 50%;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    margin-left: 40px;
}
.carname{
    font-size: 1.3rem;
    margin-bottom: 10px;
}
.left{
    text-align: center;
    width: 50%;
}

   /* Style the input field */
   input[type="date"] {
        width: 100%;
        padding: 8px;
        border: 1px solid #ccc;
        border-radius: 4px;
        font-family: Arial, sans-serif;
        font-size: 16px;
        border: none;
      
        background-color: #dfdcdc71;
        padding-right: 30px;
    }


form{
    position: relative;
    top: 8px;
}

img{
    border-radius: 14px;
    box-shadow: 6px 6px 30px rgba(0, 0, 0, 0.452);
}


.confirmbooking{
    width: 80%;
    position: relative;
    display: flex;
    gap: 20px;
    justify-content: space-between;

}

.confirmbooking .left img{
    width: 100%;
}
.container .left img{
    width: 100%;
}

#confirmbooking {
text-align: center;
width: 100%;
 border: none;
 color: #fff;
 background-image: linear-gradient(30deg, #0400ff, #4ce3f7);
 border-radius: 10px;
 background-size: 100% auto;
 font-family: inherit;
 font-size: 17px;
 padding: 0.6em 1.5em;

 position: relative;
    top:28px;
}

#confirmbooking:hover {
    background-image: linear-gradient(30deg, #0051ffd7, #4ce3f7);
    
}

.hide{
    display: none;
}

#bookButton {
text-align: center;
width: 100%;
 border: none;
 color: #fff;
 background-image: linear-gradient(30deg, #0400ff, #4ce3f7);
 border-radius: 10px;
 background-size: 100% auto;
 font-family: inherit;
 font-size: 17px;
 padding: 0.6em 1.5em;

 position: relative;
    top:20px;
    margin:  auto 0;
}

#bookButton:hover {
    background-image: linear-gradient(30deg, #0051ffd7, #4ce3f7);
    
}

input{
    width: 30%;
}




/* Tooltip */
#bookButton[disabled] {
  cursor: not-allowed;
}

#bookButton[disabled]:hover::before {
  content: attr(title);
  position: absolute;
  background-color: rgba(0, 0, 0, 0.8);
  color: #fff;
  padding: 4px 8px;
  border-radius: 4px;
  visibility: visible;
  z-index: 1;
}

</style>

</head>
<body>
    <div class="mainhead">
        <div class="dtails">
            <a href="/home" class>üöó Drivino ‚Ñ¢</a>
            <span>
                <i class="ri-phone-fill"></i>
                <p class="pinline">+91 1234567890</p>
            </span>
            <span>
                <i class="ri-mail-fill"></i>
                <a href="#">Drivino@dehradun.com</a>
            </span>
        </div>
        <div class="location-info">
        <span><i class="ri-map-pin-2-fill"></i></span>
        Dehradun City
    </div>
    </div>
        <header>
            <h3>Drivino - Rent Your Ride</h3>
            <!-- menu icon -->
            <i class="ri-menu-line" id="menu-icon"></i>
            <ul class="navbar">
                <li><a href="/home" class="hover nav-link">Home</a></li>
            <li><a href="/home#about-us"class="hover nav-link">About Us</a></li>
            <li><a href="/getCar"class="hover nav-link">Get Car</a></li>
            <li><a href="/contactUs"class="hover nav-link">Contact us</a></li>
            <li>
                <% if (loggedInUsername) { %>
                    <div class="dropdown">
                        <a href="#" class="dropbtn">
                            <a href="#" class="afterlogin" id="afterlogin">  <span class="icon"><i class="ri-user-line"></i> &nbsp;&nbsp;</span><%= loggedInname %> &nbsp;&nbsp;<i class="ri-arrow-down-s-line"></i></a>
                            <div class="dropdown-content" id="myDropdown">
                                <a href="#"><%=loggedInUsername%></a>
                                <a href="/logout" id="logoutbtn">Logout</a>
                            </a>
                        </div>
                      </div>
                <% } else { %>
                    <a href="/home" id="login-btn" class="main-btn">Login</a>
                <% } %>
        </li>
            </ul>
        </header>



<div class="parent">


    <div class="confirmbooking hide">
        <div class="left">
            <p class="carname"><b><%=data.name%></b></p>
            <img src="<%=data.img%>" alt="car img">
        </div>
        <div class="right">
            <p><b><%=data.name%></b></p>
            <p id="totaldays"></p>
            <p id="totalprice"></p>
            <button id="confirmbooking">Confirm Booking</button>
        </div>
    </div>
   



        <div class="container">
            <div class="left">
                <p class="carname"><b><%=data.name%></b></p>
                <img src="<%=data.img%>" alt="car img">
            </div>
            <div class="right">
                <div class="lineone">
                    <p><%=data.type%> | <%=data.seats%> Seats üí∫ | AC ‚ùÑÔ∏è </p>
                </div>
                <div class="linetwo">
                    ‚õΩ <%=data.fuel%> | üü¢ <%=data.transmission%> | üî∫ <%=data.mileage%>
                </div>
                <form action="">
                    <label for="fromdate">From</label>
                    <input type="date" name="fromdate" id="fromdate" required>
                    <label for="todate">To</label>
                    <input type="date" name="todate" id="todate" required>
                    <br><br>
                    <button id="bookButton"<% if (!loggedInUsername) { %>disabled<% } %> title="Please login first">Book Now</button>
                </form>
            </div>
        </div>
        
</div>
<script>
    function calculateDays() {
        const fromDate = new Date(document.getElementById('fromdate').value);
        const toDate = new Date(document.getElementById('todate').value);
        const differenceInTime = toDate.getTime() - fromDate.getTime();
        return differenceInTime / (1000 * 3600 * 24);
        
    }


    const btn = document.querySelector("#bookButton");
    const totaldays = document.querySelector("#totaldays");
    const totalprice = document.querySelector("#totalprice");
    const confirmbook = document.querySelector(".confirmbooking");
    const btn2 = document.querySelector("#confirmbooking");
    const cont = document.querySelector(".container");



//     function confirmBooking(type, carid) {
//     // Redirect to the booking page with the car ID and section ID as query parameters
//     window.location.href = `/getCar/booking/${type}/${carid}`;
// }


    const formData = new FormData(); // Define FormData object outside event listeners

btn.addEventListener("click", function (e) {
    e.preventDefault();
    
    let days = calculateDays();
    let price = days * `<%=data.price%>`; 

    if (days > 90) {
        alert("We don't provide cars for more than 3 months");
    } else if (days > 30) {
        price = price - (price * 0.10);
        totaldays.innerHTML = `Total days : <b>${days} </b>`;
        totalprice.innerHTML = `Total Price after 10% off :<b> ‚Çπ ${price} </b>`;
        cont.classList.toggle('hide');
        confirmbook.classList.toggle('hide');
        
    } else if (days > 60) {
        price = price - (price * 0.20);
        totaldays.innerHTML = `Total days : <b>${days} </b>`;
        totalprice.innerHTML = `Total Price after 20% off :<b> ‚Çπ ${price} </b>`;
        cont.classList.toggle('hide');
        confirmbook.classList.toggle('hide');
    } else {
        totaldays.innerHTML = `Total days : <b>${days} </b>`;
        totalprice.innerHTML = `Total Price: <b> ‚Çπ ${price} </b>`;
        cont.classList.toggle('hide');
        confirmbook.classList.toggle('hide');
    }

    // Toggle visibility of elements
  

   
});

btn2.addEventListener("click", function () {
    // Extract form data
    const name = '<%= loggedInname %>';
    const username = '<%= loggedInUsername %>';
    const carname = '<%= data.name %>';
    const cartype = '<%= data.type %>';
    const fromDate = document.getElementById('fromdate').value;
    const toDate = document.getElementById('todate').value;
    
    let days = calculateDays();
    let amount = days * `<%=data.price%>`;
    let rate;
     if (days > 30) {
        rate = amount - (amount * 0.10);
        cont.classList.toggle('hide');
        confirmbook.classList.toggle('hide');
    } else if (days > 60) {
        rate = amount - (amount * 0.20);
        cont.classList.toggle('hide');
        confirmbook.classList.toggle('hide');
    } 
    else{
        rate = amount;
        cont.classList.toggle('hide');
        confirmbook.classList.toggle('hide');
    }
    const price = rate;

    // Construct the query string
    const queryString = `?fromDate=${fromDate}&toDate=${toDate}&username=${username}&name=${name}&cartype=${cartype}&price=${price}`;

    // Construct the URL with query parameters
    const url = `/getCar/booking/confirm/<%= data.name %>/<%= data.id %>/${queryString}`;

    fetch(url, {
        method: 'POST'
    })
    .then(response => {
        if (!response.ok) {
            throw new Error('Network response was not ok');
        }
        return response.text();
    })
    .then(data => {
        alert("Car Booked!!!!!!");
    })
    .catch(error => {
        // Handle error
        console.error('There was an error!', error);
    });
});






    // Function to handle button click
    
</script>

</body>
</html>